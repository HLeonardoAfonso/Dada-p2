<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/images/logo.svg">
    <link href="style.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <title>Log in / Regiter</title>
</head>
<body class="d-flex align-items-start flex-column" style="height: 100vh;">
    <!-- Header -->
    <header>
        <div class="flex-row d-flex align-items-center gap-4" >
            <div class="d-flex align-items-center ">
                <a href="/"><img src="/images/logo.svg"></a>
                
                <div class="dropdown">
                    <button class="btn greyed  dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                      Categories
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        <li><a class="dropdown-item" href="#">All</a></li>
                        <li><a class="dropdown-item" href="#">Abstract</a></li>
                        <li><a class="dropdown-item" href="#">Cartoon</a></li>
                        <li><a class="dropdown-item" href="#">3D</a></li>
                        <li><a class="dropdown-item" href="#">FanArt</a></li>
                        <li><a class="dropdown-item" href="#">Manga</a></li><li><a class="dropdown-item" href="#">All</a></li>
                        <li><a class="dropdown-item" href="#">Retro</a></li>
                        <li><a class="dropdown-item" href="#">PixelArt</a></li><li><a class="dropdown-item" href="#">All</a></li>
                        <li><a class="dropdown-item" href="#">Space</a></li>
                    </ul>
                </div>
            </div>
            <div class="d-flex  align-items-center col gap-5" >
                <form class="form-floating col d-flex align-items-center text-center" >
                    <input type="text" class="form-control"  id="exampleInputSearch" aria-describedby="Search area" placeholder="Search" >
                    <label class="text-center" for="floatingInput "><i class="bi bi-search "></i> Search</label>
                </form>
                <a>Buy</a>
                <a>Sell</a>    
                <div class="dropdown">
                    <button class="btn greyed  dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                        ðŸ‡µðŸ‡¹ â‚¬ EUR
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        <li><a class="dropdown-item" href="#">â‚¬ EUR</a></li>
                        <li><a class="dropdown-item" href="#">$ USD</a></li>
                        <li><a class="dropdown-item" href="#">Â£ GBP</a></li>
                    </ul>
                </div>  
            </div>
            <div class="col-md-2 d-inline-flex gap-2 ">
                <a href="/register" class="underline-none fit-100">
                    <button class="btn-white  fit-100">
                        <i class="bi bi-person-circle"></i> &nbsp; Log in / Register
                    </button>
                </a>
                <a ><i class="bi bi-star fs-4 " ></i></a>
                <a ><i class="bi bi-cart fs-4" ></i></a>
            </div>
        </div>
        <div class="pt-3 d-flex  align-items-center gap-2 justify-content-between">
            <a href="/search"><button class="btn-cian ">All</button></a>
            <button class="btn-cian">Abstract</button>
            <button class="btn-cian">Cartoon</button>
            <button class="btn-cian">3D</button>
            <button class="btn-cian">Fan Art</button>
            <button class="btn-cian">Manga</button>
            <button class="btn-cian">Retro</button>
            <button class="btn-cian">Pixel Art</button>
            <button class="btn-cian">Space</button>
            
            <button class="btn-white btn-large col-2">
                <i class="bi bi-download"></i> &nbsp; Download App
            </button>
        </div>
    </header>

    <!-- Body -->
    <div class="fit-100 d-flex gap-5 justify-content-center">

        <!-- Sign in --> 

        <div class="d-flex align-items-center justify-content-center border border-2 border-secondary rounded-3 m-3" >
            <div class="d-flex flex-column align-items-center m-5">
                <h3 class="mb-3">Sign in</h3>
                <!-- <input type="text" name="name" placeholder="Username" class="m-2 p-1" > -->
                <input type="email" name="email" placeholder="Email" class="m-2 p-1" id="userin" required>
                <input type="password" name="password" placeholder="Password" class="m-2 mb-4 p-1" id="pswdin" required>

                            <button class="btn-purp" onclick="validaLogin()">Login</button>

                <!-- <button type="button" class="btn btn-primary" onclick="validaLogin()">le token</button> -->
                <a href="/forgot" >Forgot password?</a>
            </div>
        </div>

        <!-- Sign up -->
        
        <div class="d-flex align-items-center justify-content-center bg-secondary rounded-3 m-3" >
            <form class="d-flex flex-column align-items-center m-5" >
                <h3 class="mb-3">Sign up</h3>
                <input type="text" name="name" placeholder="Create username" class="m-2 p-1" id="nome" required >
                <input type="email" name="email" placeholder="Email" class="m-2 p-1" id="email" required >
                <input type="password" name="password" placeholder="Password" class="m-2 p-1" id="pswd" required>
                <input type="password" name="password" placeholder="Re type password" class="m-2 mb-4 p-1" id="coPwd" required>
                <button type="submit" class="btn-purp" onclick="validaPassword()">
                    <img src="/icons/go.png" class="icon"  >Register
                </button>
            </form>
        </div>
    </div>
    <!-- Footer -->
    <footer class="mt-auto ">
        <div class="flex-column">
            <div class="d-flex mx-2 ">
                <div class="d-flex col-3 flex-column mx-2">
                    <div class="d-flex gap-4  align-items-center  ">
                        <a href="/" class="col-4 "><img src="/images/logo.svg" class="fit-100"></a>
                        <div class=" flex-column mx-auto gap-2 align-items-center ">
                            <h6 class="text-center "> DADAÂ© 2023</h6>
                            <div class="d-flex  flex-wrap gap-2 m-2">
                                <i class="bi bi-behance" ></i>
                                <i class="bi bi-pinterest"></i>
                                <i class="bi bi-tiktok"></i>
                                <i class="bi bi-instagram"></i>
                                <i class="bi bi-twitter"></i>
                                <i class="bi bi-youtube"></i>
                                <i class="bi bi-snapchat"></i>
                                <i class="bi bi-facebook"></i>
                            </div>
                        </div> 
                    </div> 
                    <div class="flex-row align-items-center m-2">
                            <div class="text-center m-2">Download</div>
                            <div class="d-flex d-row gap-2 mx-2">
                                <button class="btn-white fit-100">
                                    <i class="bi bi-apple"></i> App Store
                                </button>
        
                                <button class="btn-white fit-100">
                                    <i class="bi bi-play"></i> Google Play
                                </button>
                            </div>
                    </div>
                </div>
                <div class=" d-flex col-3 flex-row mx-2 ">
                    <div class="col  mx-auto justify-content-between ">
                        <p>About</p>
                        <p class="smalltext ">About DADA</p>
                        <p class="smalltext ">Collections</p>
                        <p class="smalltext ">Who we are</p>
                        <p class="smalltext ">Contacts</p>
                        <p class="smalltext ">Jobs</p>
                        <p class="smalltext ">News</p>
                        <p class="smalltext ">Archive</p>
                        <p class="smalltext ">Press</p>
                    </div>
                    <div class="col">
                        <p>Buy</p>
                        <p class="smalltext ">Hire expert</p>
                        <p class="smalltext ">FAQ</p>
                        <p class="smalltext ">Payment</p>
                        <p class="smalltext ">Help</p>
                        <p class="smalltext ">Testimonials</p>
                        <p class="smalltext ">Buyer Policy</p>
                        <p class="smalltext ">Gift Card</p>
                        <p class="smalltext ">Refer a friend</p>
                    </div>
                    <div class="col">
                        <p>Sell</p>
                        <p class="smalltext ">Apply as artist</p>
                        <p class="smalltext ">Artist's handbook</p>
                        <p class="smalltext ">Payment</p>
                        <p class="smalltext ">Help</p>
                        <p class="smalltext ">Seller Policy</p>
                        <p class="smalltext ">FAQ</p>
                    </div>
                </div>
                <div class="d-flex col-3 flex-column align-items-center mx-2">
                    <h4 >Over 500+ Reviews</h4>
                    <img src="images/trustpilot.png" class="img-fluid">
                    <img src="images/starsvoting.png" class="img-fluid">
                    <p class="mt-4 mb-0 fw-bold" >Secure Payment</p>
                    <div class="d-flex gap-4 m-1">
                        <i class="bi bi-paypal"></i>
                        <i class="bi bi-currency-bitcoin"></i>
                        <i class="bi bi-stripe"></i>
                        <i class="bi bi-amazon"></i>
                    </div>
                </div>
                <div class="d-flex col-3 flex-column     ">
                    <div class="d-flex gap-3 m-2  align-items-center ">
                        <div class=""><button class="btn-purp ">
                            <i class="bi bi-gift "></i> &nbsp; Gift Card
                        </button></div>
                        <div class="text-end px-5 ">DADAÂ© 2023</div>
                    </div>
                    <div class="mx-2 px-5">
                        <p  class="smalltext fw-bold text-end">www.dada.art</p>
                        <p  class="smalltext text-end ">New Road 515 , West Side, Portugal</p>
                    </div>
                    <div class="m-2">
                        <p>Subscribe to newsletter</p>
                        <form class="d-flex pe-5">
                            <input type="text" class="form-control d-flex "  id="newsletter" aria-describedby="Search area" placeholder="your email here"  >
                        </form>
                    </div>
                </div>
            </div>
            <hr>
            <div class="d-flex text-center">
                <div class="col"><h6>Terms and Conditions</h6></div>
                <div class="col"><h6>Privacy Policy</h6></div>
                <div class="col"><h6>Cookie Policy</h6></div>
                <div class="col"><h6>Legal Notice</h6></div>
            </div> 
        </div>
    </footer>
    <script type="text/JavaScript">

        const newUser = async () => {
            var dados = {
                email: document.getElementById("email").value,
                name: document.getElementById("nome").value,
                password: document.getElementById("pswd").value,
                isAdmin: false,
            };
            fetch("http://localhost:4242/api/auth/signup", {
                method: "POST",
                headers: {"Content-Type": "application/json",},
                body: JSON.stringify(dados),
            })
            .then((response) => {
                if (!response.ok) {
                    throw new Error("Error finding data");
                }
                return response.json();
            })
            .then((data) => {
                alert("The " + dados.name + " foi adicionado com sucesso!");
            })
            .catch((error) => { alert("ERROR:", error); });
        };

        function validaPassword() {
            var password1 = document.getElementById("pswd").value;
            var password2 = document.getElementById("coPwd").value;
    
            // Validate through RegularExpression
            // var passwordcheck1 =/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{8,15}$/;
    
            // if (!passwordcheck1.test(password1)){
            //     alert("Password invÃ¡lida not ok");
            //     return false;
            // }
            if(!password1.match(password2)){
                alert("The password and confirmation are not the same");
            return false;
            }
            newUser();
            alert("You have been registered");
            return true;
        }

        const validaLogin = async () => {

            var dados = {
                email: document.getElementById("userin").value,
                password: document.getElementById("pswdin").value,
            };

            const response= await fetch("http://localhost:4242/api/auth/signin", {
                method: "POST",
                headers: {
                "Content-Type": "application/json",
                },
                body: JSON.stringify(dados),
            });
            // console.log(response.ok);
            dados= await  response.json()
            if(!response.ok){
                alert("Error on login");
            }
            else{
                // alert("Login sucessful");
                console.log(dados.id);
                // Guardar o token no local storage
                localStorage.setItem("token", dados.token);
                localStorage.setItem("id", dados.id);
                console.log(dados.token);
                window.location.href = "/artist";
                // +dados.id
            }
        };

        const leTokenSFF = async () => {
            var dados = {
                token: localStorage.getItem("token"),
            };
            // console.log(JSON.stringify(dados));
            const response= await fetch("http://localhost:4242/api/auth/letoken", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(dados),
            })
            // console.log(response);
            dados= await  response.json()
            // console.log(dados);
            if(!response.ok){
                alert("Error on login");
            } else {
                // alert("token lido com sucesso");
                // console.log(dados);
                validaLogin();
            }
        };
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>